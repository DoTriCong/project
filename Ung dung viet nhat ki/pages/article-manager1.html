<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="../css/article-manager1.css" />
  </head>
  <body>
    <section class="article-details">
      <div class="post">
        <img src="../assets/icons/Back.png" alt="" />
        <div class="post-header">
          <img src="../assets/images/Avatar.png" alt="User Avatar" />
          <div class="post-info">
            <h3>A Productive Day at Work</h3>
            <p class="summary">
              Today was a really productive day at work. I managed to finish a
              report ahead of schedule and received positive feedback from my
              manager.
            </p>
            <p class="stats">Likes: 15 ðŸ’“ Replies: 6 ðŸ—¯</p>
          </div>
        </div>
      </div>
      <div class="comments-section">
        <h4>Comments</h4>
        <!-- Khu vá»±c hiá»ƒn thá»‹ bÃ¬nh luáº­n -->
        <div id="comments-container">
          <!-- CÃ¡c bÃ¬nh luáº­n sáº½ Ä‘Æ°á»£c render táº¡i Ä‘Ã¢y -->
        </div>

        <!-- Form viáº¿t bÃ¬nh luáº­n má»›i -->
        <form id="comment-form">
          <input
            type="text"
            id="comment-text"
            placeholder="Viáº¿t bÃ¬nh luáº­n cá»§a báº¡n táº¡i Ä‘Ã¢y..."
            required
          />
          <button type="submit">BÃ¬nh luáº­n</button>
        </form>
      </div>
    </section>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const articleData = JSON.parse(localStorage.getItem("selectedArticle"));

        if (articleData) {
          // Hiá»ƒn thá»‹ thÃ´ng tin bÃ i viáº¿t
          document.querySelector(".post-info h3").innerText = articleData.title;
          document.querySelector(".post-info .summary").innerText =
            articleData.content;
          document.querySelector(".post img").src = articleData.image;

          // Hiá»ƒn thá»‹ bÃ¬nh luáº­n hiá»‡n táº¡i
          const commentsContainer =
            document.getElementById("comments-container");
          commentsContainer.innerHTML = ""; // XÃ³a ná»™i dung cÅ©
          if (articleData.comments && articleData.comments.length > 0) {
            articleData.comments.forEach((comment) => {
              const commentElement = document.createElement("div");
              commentElement.classList.add("comment");
              commentElement.innerHTML = `
          <p><img src="${comment.avatar}" alt="Avatar" /> ${comment.text}</p>
          <p class="stats">Likes: ${comment.likes} ðŸ’“ Replies: ${comment.replies} ðŸ—¯</p>
        `;
              commentsContainer.appendChild(commentElement);
            });
          } else {
            commentsContainer.innerHTML = `<p>KhÃ´ng cÃ³ bÃ¬nh luáº­n nÃ o.</p>`;
          }
        }

        // Xá»­ lÃ½ form gá»­i bÃ¬nh luáº­n má»›i
        const commentForm = document.getElementById("comment-form");
        commentForm.addEventListener("submit", (e) => {
          e.preventDefault(); // NgÄƒn reload trang

          // Láº¥y ná»™i dung bÃ¬nh luáº­n má»›i
          const commentText = document
            .getElementById("comment-text")
            .value.trim();
          if (!commentText) return;

          // Táº¡o bÃ¬nh luáº­n má»›i
          const newComment = {
            avatar: "../assets/images/default-avatar.png", // Avatar máº·c Ä‘á»‹nh
            text: commentText,
            likes: 0,
            replies: 0,
          };

          // Cáº­p nháº­t danh sÃ¡ch bÃ¬nh luáº­n
          if (!articleData.comments) {
            articleData.comments = [];
          }
          articleData.comments.push(newComment); // ThÃªm vÃ o máº£ng comments
          localStorage.setItem("selectedArticle", JSON.stringify(articleData)); // Cáº­p nháº­t localStorage

          // Hiá»ƒn thá»‹ bÃ¬nh luáº­n má»›i ngay trÃªn giao diá»‡n
          const commentElement = document.createElement("div");
          commentElement.classList.add("comment");
          commentElement.innerHTML = `
      <p><img src="${newComment.avatar}" alt="Avatar" /> ${newComment.text}</p>
      <p class="stats">Likes: ${newComment.likes} ðŸ’“ Replies: ${newComment.replies} ðŸ—¯</p>
    `;
          commentsContainer.appendChild(commentElement); // ThÃªm vÃ o giao diá»‡n

          // Reset Ã´ nháº­p liá»‡u
          document.getElementById("comment-text").value = "";
        });
      });
    </script>
  </body>
</html>
